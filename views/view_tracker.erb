<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Coverband Info: <%= Coverband::VERSION %></title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <script src='<%= assets_path('dependencies.js') %>' type='text/javascript'></script>
    <script src='<%= assets_path('application.js') %>' type='text/javascript'></script>
    <link href='<%= assets_path('application.css') %>' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link rel="icon" type="image/png" href="<%= assets_path('favicon.png') %>" />
  </head>

  <body>
    <div id="wrapper" style="">
      <%= display_nav(active_link: 'view_tracker') %>
      <div id="content">
        <% tracker = Coverband::Collectors::ViewTracker.new(store: Coverband.configuration.store) %>
        <h4>
          <% if Coverband.configuration.web_enable_clear %>
            <%= button("#{base_path}clear_view_tracking", 'reset view tracker', delete: true) %>
          <% end %>
          <% if Coverband.configuration.web_debug %>
            <a href='<%= "#{base_path}view_tracker_data" %>'>view tracker data</a>
          <% end %>
        </h4>
        <h2>Unused Views: (<%= tracker.unused_keys.length %>)</h2>
        <p>These views have not been rendered since recording started at <%= tracker.tracking_since %></p>
        <ul>
        <% tracker.unused_keys.each do |view_file| %>
          <li class="unused-views"><%= view_file %></li>
        <% end %>
        </ul>

        <h2>Used Views: (<%= tracker.used_keys.length %>)</h2>
        <p>These views have been rendered at least once</p>
        <ul>
        <% tracker.used_keys.each_pair do |view_file, time_at| %>
          <li class="used-views">
            <%= view_file %>
            <span class="last_seen_at">last activity recorded <%= Time.at(time_at.to_i)%></span>
            <% if Coverband.configuration.web_enable_clear %>
              <%= button("#{base_path}clear_view_tracking_file?filename=#{view_file}", 'reset tracked file', delete: true) %>
            <% end %>
          </li>
        <% end %>
        </ul>
      </div>
      <div id="footer">
        Generated by <a href="http://github.com/danmayer/coverband">Coverband</a> v<%= Coverband::VERSION %>
      </div>
    </div>
  </body>
</html>
